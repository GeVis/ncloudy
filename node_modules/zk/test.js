"use strict";

var Zookeeper = require('./index');
var Lock = Zookeeper.Lock;
var Promise = require('bluebird');

var zk = new Zookeeper({
    timeout: 5000
}), lock;

zk.on('close', console.log);

var p = zk.connect().then(function() {
    lock = new Lock(zk, 'some-lock');
});

p = p.then(function() {

    return lock.lock(function() {
        console.log('I got the lock!');

        return Promise.delay(5000).then(function(){
            console.log('unlocking!');
        });
    });
});





