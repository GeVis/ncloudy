"use strict";

var Zookeeper = require('./index');
var Lock = Zookeeper.Lock;
var Promise = require('bluebird');
var _ = require('lodash');

var zk = new Zookeeper();

zk.connect().then(function() {

    return Promise.all(_.range(0, 1000).map(function () {
        var lock = new Lock(zk, 'some-lock');

        return lock.lock(function() {
            console.log('I got the lock!');

            /*return Promise.delay(50).then(function(){
                console.log('unlocking!')
            })*/
        });

    }));

});





