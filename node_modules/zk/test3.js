"use strict";

var Zookeeper = require('./index');
var Promise = require('bluebird');

var zk = new Zookeeper(), path;

var p = zk.connect().then(function() {
    return zk.create('/test-node-', 0, Zookeeper.ZOO_SEQUENCE | Zookeeper.ZOO_EPHEMERAL).then(function(_path) {
        path = _path;
    });
});

p = p.then(function() {
    return zk.get(path, true).then(function(reply) {
        console.log(reply);
        reply.watch.then(function(event) {
            console.log(event);
        });
    });
});


Promise.delay(2000).then(function(){
    // return zk.set(path, 1, -1)
});
